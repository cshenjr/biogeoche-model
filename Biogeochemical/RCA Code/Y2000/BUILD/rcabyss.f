      MODULE ALLOCENDUMPS
      REAL, ALLOCATABLE, DIMENSION(:,:,:,:) :: DUMPS
      END MODULE ALLOCENDUMPS
      SUBROUTINE  RCABYSS (NGDMP,JSYS)
C
C        RCABYSS PRODUCES A SYSTEM DUMP FILE FROM THE MASTER DUMP FILE
C                (RCAF11) GENERATED BY THE USER KINETIC SUBR. -TUNER-
C
      USE ALLOCENDUMPS
      SAVE
      INCLUDE  'RCACM'
      ALLOCATE(DUMPS(NX,NY,NZ,NGDMP))
C        LOOP TO READ DUMP FILE INTO CORE ARRAY
      REWIND 11
      DO 50 IT=1,IREC
       DO 25 ISYSTEM=1,NGDMP
        READ(11)  (((DUMPS(IX,IY,IZ,ISYSTEM),IX=1,NX),IY=1,NY),
     .      IZ=1,NZ)
   25 CONTINUE
C        MOVE FROM READ BUFFER TO VIRTUAL ARRAY
      DO 40 IZ=1,NZ
       DO 40 IY=1,NY
        DO 40 IX=1,NX
   40 SCRATCH_ARRAY(IX,IY,IZ,IT) = DUMPS(IX,IY,IZ,JSYS)
   50 CONTINUE
      DEALLOCATE(DUMPS)
      RETURN
      END
